/**
 * Navbar Theme Integration v2.0
 * - Uses CSS variables set by GlobalThemeProvider
 * - Theme colors applied via var(--accent-color) and var(--accent-rgb)
 * - No direct filter on navbar - uses color variables instead
 */

/* ============================================================================
   THEME-AWARE NAVBAR COLORS
   Uses CSS variables for dynamic theme color application
   ============================================================================ */

:root {
  /* Default accent (blue) - overridden by GlobalThemeProvider */
  --navbar-accent: var(--accent-color, #3b82f6);
  --navbar-accent-rgb: var(--accent-rgb, 59, 130, 246);
  
  /* Derived navbar colors */
  --navbar-border: rgba(var(--navbar-accent-rgb), 0.3);
  --navbar-glow: rgba(var(--navbar-accent-rgb), 0.15);
  --navbar-hover: rgba(var(--navbar-accent-rgb), 0.2);
  --navbar-active: rgba(var(--navbar-accent-rgb), 0.25);
}

/* ============================================================================
   NAVBAR CONTAINER - THEME INTEGRATION
   - No filter applied (preserves fixed positioning)
   - Uses CSS variables for color theming
   ============================================================================ */

.navbar-themed {
  z-index: 40;
  /* NO FILTER - use color variables instead */
  transition: border-color 0.5s ease-in-out, box-shadow 0.5s ease-in-out;
  position: fixed;
  top: 8px;
  left: 0;
  right: 0;
  width: 100%;
  pointer-events: none;
  /* Theme-aware border and glow */
  border-color: var(--navbar-border) !important;
  box-shadow: 
    0 0 20px var(--navbar-glow),
    inset 0 0 30px rgba(var(--navbar-accent-rgb), 0.03);
}

/* Navbar elements use theme accent color */
.navbar-themed a,
.navbar-themed button {
  /* Links and buttons get theme color on hover */
  transition: color 0.3s ease, text-shadow 0.3s ease;
}

.navbar-themed a:hover,
.navbar-themed button:hover {
  color: var(--navbar-accent) !important;
  text-shadow: 0 0 10px var(--navbar-glow);
}

/* Active nav items get theme color */
.navbar-themed .active,
.navbar-themed [aria-current="page"] {
  color: var(--navbar-accent);
  text-shadow: 0 0 8px var(--navbar-glow);
}

/* ============================================================================
   Z-INDEX STACKING CONTEXT
   Ensures proper layering across the application
   ============================================================================ */

/* Lowest layer - Page content */
body {
  z-index: 1;
}

/* Navbar - Below loaders */
[data-navbar-container],
.navbar-themed {
  z-index: 40;
}

/* Loaders & Modals - Above navbar */
.multi-step-loader,
[role="dialog"],
.modal,
.loader {
  z-index: 50;
}

/* Fixed overlays and high-priority elements */
.fixed-overlay,
.backdrop,
[class*="backdrop"] {
  z-index: 45;
}

/* Top-level UI elements */
.tooltip,
.popover,
.dropdown {
  z-index: 55;
}

/* Control panel - Highest priority */
.control-panel-themed {
  z-index: 60;
}

/* ============================================================================
   SMOOTH TRANSITIONS
   Filter and opacity transitions for theme changes
   ============================================================================ */

.navbar-themed,
[data-navbar-container],
.control-panel-themed {
  transition: 
    filter 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
    background-color 0.3s ease,
    border-color 0.3s ease,
    box-shadow 0.3s ease;
}

/* ============================================================================
   TOOLTIP & TIP ANIMATIONS
   Enhanced animations for navbar tips and helper tooltips
   ============================================================================ */

@keyframes tipSlideUp {
  from {
    opacity: 0;
    transform: translateY(8px) translateX(-50%);
  }
  to {
    opacity: 1;
    transform: translateY(0) translateX(-50%);
  }
}

@keyframes tipSlideDown {
  from {
    opacity: 1;
    transform: translateY(0) translateX(-50%);
  }
  to {
    opacity: 0;
    transform: translateY(8px) translateX(-50%);
  }
}

@keyframes tipPulseGlow {
  0% {
    box-shadow: 0 0 15px rgba(59, 130, 246, 0.2), inset 0 0 20px rgba(59, 130, 246, 0.1);
  }
  50% {
    box-shadow: 0 0 25px rgba(59, 130, 246, 0.4), inset 0 0 30px rgba(59, 130, 246, 0.15);
  }
  100% {
    box-shadow: 0 0 15px rgba(59, 130, 246, 0.2), inset 0 0 20px rgba(59, 130, 246, 0.1);
  }
}

@keyframes dotPulse {
  0%, 100% {
    opacity: 0.6;
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(1.2);
  }
}

@keyframes textFadeIn {
  from {
    opacity: 0;
    clip-path: inset(0 100% 0 0);
  }
  to {
    opacity: 1;
    clip-path: inset(0 0 0 0);
  }
}


/* Tooltip styling with glow animation */
[role="tooltip"] {
  animation: tipSlideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

/* Mobile tip glow animation */
.mobile-helper-tip {
  animation: tipPulseGlow 3s ease-in-out infinite;
}

/* ============================================================================
   DOCK ITEM HOVER EFFECTS
   Enhanced visual feedback for dock items
   ============================================================================ */

.dock-item-base {
  transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.dock-item-base:hover {
  transform: translateY(-4px);
}

.dock-icon-container {
  position: relative;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.dock-icon-container::before {
  content: '';
  position: absolute;
  inset: -8px;
  background: radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, transparent 70%);
  border-radius: 2rem;
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
}

.dock-icon-container:hover::before {
  opacity: 1;
}

/* ============================================================================
   PULSING INDICATOR ANIMATIONS
   Better pulse effects for notification dots
   ============================================================================ */

.pulse-indicator {
  position: relative;
  display: flex;
  height: 8px;
  width: 8px;
}

.pulse-indicator-ring {
  animation: dotPulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  position: absolute;
  inset: 0;
  border-radius: 50%;
}

.pulse-indicator-dot {
  position: relative;
  height: 100%;
  width: 100%;
  border-radius: 50%;
}

/* ============================================================================
   TEXT ROTATION ANIMATION
   For rotating tips in tooltips
   ============================================================================ */

@keyframes rotateTextIn {
  from {
    opacity: 0;
    transform: rotateX(-90deg) translateY(5px);
  }
  to {
    opacity: 1;
    transform: rotateX(0) translateY(0);
  }
}

@keyframes rotateTextOut {
  from {
    opacity: 1;
    transform: rotateX(0) translateY(0);
  }
  to {
    opacity: 0;
    transform: rotateX(90deg) translateY(-5px);
  }
}

/* ============================================================================
   ENHANCED BUTTON STATE ANIMATIONS
   Better feedback for interactive elements
   ============================================================================ */

/* ============================================================================
   ENHANCED BUTTON STATE ANIMATIONS
   Better feedback for interactive elements
   ============================================================================ */

.nav-button {
  position: relative;
  overflow: hidden;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.nav-button::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(59, 130, 246, 0.1);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
  pointer-events: none;
}

.nav-button:hover::after {
  width: 300px;
  height: 300px;
}

/* ============================================================================
   GLASS MORPHISM EFFECTS
   Premium glass effects for modern UI
   ============================================================================ */

.glass-effect {
  background: rgba(0, 0, 0, 0.85);
  /* NO BLUR - removed for performance */
  border: 1.5px solid rgba(255, 255, 255, 0.2);
}

.glass-effect-heavy {
  background: rgba(0, 0, 0, 0.92);
  /* NO BLUR - removed for performance */
  border: 2px solid rgba(59, 130, 246, 0.4);
}

.glass-effect-light {
  background: rgba(0, 0, 0, 0.7);
  /* NO BLUR - removed for performance */
  border: 1.5px solid rgba(59, 130, 246, 0.35);
}


/* ============================================================================
   ENHANCED MOBILE CONTROLS GLASS STYLING
   Premium mobile navbar styling
   ============================================================================ */

.mobile-controls-glass {
  background: rgba(0, 0, 0, 0.9);
  /* NO BLUR - removed for performance */
  border: 2px solid rgba(59, 130, 246, 0.55);
  box-shadow: 
    0 8px 32px 0 rgba(31, 38, 135, 0.25),
    inset 0 0 25px rgba(59, 130, 246, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

.mobile-controls-glass:hover {
  border-color: rgba(59, 130, 246, 0.6);
  box-shadow: 
    0 8px 40px 0 rgba(31, 38, 135, 0.25),
    inset 0 0 30px rgba(59, 130, 246, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

/* ============================================================================
   DESKTOP DOCK GLASS STYLING
   Enhanced dock appearance with glass morphism
   ============================================================================ */

.dock-glass {
  background: rgba(0, 0, 0, 0.9);
  /* NO BLUR - removed for performance */
  border: 2px solid rgba(59, 130, 246, 0.5);
  box-shadow:
    0 8px 32px 0 rgba(31, 38, 135, 0.25),
    inset 0 1px 0 rgba(255, 255, 255, 0.12),
    inset 0 0 25px rgba(59, 130, 246, 0.12);
}

.dock-glass:hover {
  border-color: rgba(59, 130, 246, 0.6);
  box-shadow:
    0 8px 40px 0 rgba(31, 38, 135, 0.25),
    inset 0 1px 0 rgba(255, 255, 255, 0.12),
    inset 0 0 30px rgba(59, 130, 246, 0.12);
}

/* ============================================================================
   ICON GLASS CONTAINERS
   Enhanced icon button styling
   ============================================================================ */

.icon-glass {
  background: rgba(0, 0, 0, 0.6);
  /* NO BLUR - removed for performance */
  border: 1px solid rgba(59, 130, 246, 0.3);
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.icon-glass:hover {
  background: rgba(0, 0, 0, 0.7);
  border-color: rgba(59, 130, 246, 0.5);
  box-shadow: 0 0 25px rgba(59, 130, 246, 0.3);
}

/* ============================================================================
   TOOLTIP GLASS STYLING
   Enhanced tooltip appearance
   ============================================================================ */

.tooltip-glass {
  background: rgba(0, 0, 0, 0.9);
  /* NO BLUR - removed for performance */
  border: 1px solid rgba(59, 130, 246, 0.45);
  box-shadow:
    0 8px 32px rgba(31, 38, 135, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.08),
    0 0 30px rgba(59, 130, 246, 0.3);
}

/* ============================================================================
   MENU GLASS STYLING
   Enhanced mobile menu styling
   ============================================================================ */

.menu-glass {
  background: rgba(0, 0, 0, 0.95);
  /* NO BLUR - removed for performance */
  border: 2px solid rgba(59, 130, 246, 0.55);
  box-shadow:
    0 12px 48px 0 rgba(31, 38, 135, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.15),
    inset 0 0 35px rgba(59, 130, 246, 0.12);
}

.glass-active {
  background: rgba(0, 0, 0, 0.6);
  border-color: rgba(59, 130, 246, 0.7);
  box-shadow: 0 0 40px rgba(59, 130, 246, 0.5);
}

/* ============================================================================
   MEDIA QUERIES
   Ensure proper z-index and theme behavior on different screen sizes
   ============================================================================ */

@media (max-width: 1024px) {
  .navbar-themed {
    z-index: 40;
  }
}

@media (max-width: 640px) {
  .navbar-themed {
    z-index: 40;
    /* NO filter on mobile - use color variables for theming */
  }
}

/* ============================================================================
   ANIMATION STATES
   Theme colors apply during animations
   ============================================================================ */

.navbar-themed[data-animating="true"] {
  /* No filter during animation - rely on color variables */
  z-index: 40;
}

/* Reduce motion */
@media (prefers-reduced-motion: reduce) {
  .navbar-themed,
  [data-navbar-container],
  .control-panel-themed {
    transition: none;
  }
}

/* ============================================================================
   PERFORMANCE OPTIMIZATIONS
   CSS containment, will-change, and GPU acceleration hints
   ============================================================================ */

/* Containment for dock items - isolates layout/paint */
.dock-item-optimized {
  contain: layout style;
  will-change: transform, width, height;
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* Navbar container containment */
.navbar-themed {
  contain: layout style;
  will-change: opacity;
}

/* Optimize tooltips */
.tooltip-optimized {
  contain: layout paint style;
  will-change: transform, opacity;
  transform: translateZ(0);
}

/* Reduce animation cost for mobile tips */
.mobile-helper-optimized {
  contain: layout paint style;
  will-change: transform, opacity;
  transform: translateZ(0);
}

/* GPU-accelerated animations */
.gpu-accelerated {
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
}

/* Disable expensive effects on low-end devices */
@media (max-width: 768px) {
  .dock-glass {
    /* NO BLUR - removed for performance */
    background: rgba(0, 0, 0, 0.85);
  }
  
  .menu-glass {
    /* NO BLUR - removed for performance */
    background: rgba(0, 0, 0, 0.95);
  }
}

/* Reduce animations when battery saver is on */
@media (prefers-reduced-motion: reduce) {
  .dock-item-optimized {
    will-change: auto;
    transition: none !important;
  }
  
  .animate-ping {
    animation: none !important;
  }
  
  .mobile-helper-optimized {
    animation: none !important;
  }
}

/* ============================================================================
   APPLE DEVICE & INSTAGRAM MOBILE PREMIUM SHIMMER (2026 Update)
   Full quality LEFT-TO-RIGHT BACKGROUND shimmer on navbar for Apple devices and Instagram
   ============================================================================ */

/* Enable full shimmer on Apple mobile navbar */
@media (max-width: 768px) {
  /* Apple premium - full quality shimmer on navbar */
  html.apple-premium .navbar-shimmer,
  html.instagram-premium .navbar-shimmer {
    overflow: hidden !important;
    position: relative;
  }
  
  /* Mobile controls glass - ANIMATED BACKGROUND instead of black */
  html.apple-premium .mobile-controls-glass,
  html.instagram-premium .mobile-controls-glass {
    background: linear-gradient(
      90deg,
      rgba(0, 0, 0, 0.95) 0%,
      rgba(10, 25, 50, 0.95) 25%,
      rgba(20, 40, 80, 0.95) 50%,
      rgba(10, 25, 50, 0.95) 75%,
      rgba(0, 0, 0, 0.95) 100%
    ) !important;
    background-size: 200% 100% !important;
    animation: navbarBgGradientLTR 4s ease-in-out infinite !important;
    box-shadow: 
      0 0 30px rgba(59, 130, 246, 0.5),
      0 0 60px rgba(59, 130, 246, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
    border-color: rgba(59, 130, 246, 0.7) !important;
  }
  
  /* Inner container also gets animated bg */
  html.apple-premium .navbar-shimmer > div,
  html.instagram-premium .navbar-shimmer > div {
    background: linear-gradient(
      90deg,
      rgba(0, 0, 0, 0.95) 0%,
      rgba(8, 20, 45, 0.95) 20%,
      rgba(15, 35, 70, 0.95) 40%,
      rgba(25, 50, 100, 0.95) 50%,
      rgba(15, 35, 70, 0.95) 60%,
      rgba(8, 20, 45, 0.95) 80%,
      rgba(0, 0, 0, 0.95) 100%
    ) !important;
    background-size: 300% 100% !important;
    animation: navbarInnerBgLTR 5s ease-in-out infinite !important;
  }
  
  /* BACKGROUND SHIMMER - sweeps left to right across entire navbar */
  html.apple-premium .navbar-shimmer::before,
  html.instagram-premium .navbar-shimmer::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(59, 130, 246, 0.08) 20%,
      rgba(59, 130, 246, 0.2) 35%,
      rgba(147, 197, 253, 0.35) 50%,
      rgba(59, 130, 246, 0.2) 65%,
      rgba(59, 130, 246, 0.08) 80%,
      transparent 100%
    );
    animation: navbarBgShimmerLTR 5s ease-in-out infinite;
    z-index: 0;
    pointer-events: none;
    border-radius: inherit;
  }
  
  /* Ensure all icons and buttons in navbar stay visible above shimmer */
  html.apple-premium .navbar-shimmer button,
  html.apple-premium .navbar-shimmer a,
  html.apple-premium .navbar-shimmer svg,
  html.apple-premium .navbar-shimmer [role="button"],
  html.apple-premium .navbar-shimmer .nav-button,
  html.instagram-premium .navbar-shimmer button,
  html.instagram-premium .navbar-shimmer a,
  html.instagram-premium .navbar-shimmer svg,
  html.instagram-premium .navbar-shimmer [role="button"],
  html.instagram-premium .navbar-shimmer .nav-button {
    position: relative;
    z-index: 5 !important;
  }
  
  /* Icons - color aware with blue tint and glow */
  html.apple-premium .navbar-shimmer svg,
  html.instagram-premium .navbar-shimmer svg {
    z-index: 10 !important;
    color: rgba(147, 197, 253, 1) !important;
    filter: drop-shadow(0 0 4px rgba(59, 130, 246, 0.5));
    transition: color 0.3s ease, filter 0.3s ease;
  }
  
  /* Icons glow brighter on active/hover */
  html.apple-premium .navbar-shimmer button:active svg,
  html.apple-premium .navbar-shimmer a:active svg,
  html.instagram-premium .navbar-shimmer button:active svg,
  html.instagram-premium .navbar-shimmer a:active svg {
    color: rgba(255, 255, 255, 1) !important;
    filter: drop-shadow(0 0 8px rgba(147, 197, 253, 0.9)) drop-shadow(0 0 15px rgba(59, 130, 246, 0.6));
  }
  
  /* Pulse glow animation on icons when shimmer passes */
  html.apple-premium .navbar-shimmer svg,
  html.instagram-premium .navbar-shimmer svg {
    animation: iconPulseGlow 5s ease-in-out infinite;
  }
}

/* Icon pulse glow synced with shimmer */
@keyframes iconPulseGlow {
  0%, 100% {
    filter: drop-shadow(0 0 4px rgba(59, 130, 246, 0.4));
    color: rgba(147, 197, 253, 0.9);
  }
  40% {
    filter: drop-shadow(0 0 6px rgba(59, 130, 246, 0.6));
  }
  50% {
    filter: drop-shadow(0 0 10px rgba(147, 197, 253, 0.9)) drop-shadow(0 0 20px rgba(59, 130, 246, 0.5));
    color: rgba(255, 255, 255, 1);
  }
  60% {
    filter: drop-shadow(0 0 6px rgba(59, 130, 246, 0.6));
  }
}

/* Top border shimmer line - bright accent */
@media (max-width: 768px) {
  html.apple-premium .navbar-shimmer::after,
  html.instagram-premium .navbar-shimmer::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 2px;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(59, 130, 246, 0.5) 15%,
      rgba(147, 197, 253, 1) 50%,
      rgba(59, 130, 246, 0.5) 85%,
      transparent 100%
    );
    animation: navbarBorderShimmerLTR 5s ease-in-out infinite;
    z-index: 10;
    filter: drop-shadow(0 0 6px rgba(59, 130, 246, 0.8));
    pointer-events: none;
  }
  
  /* Nav buttons glow on Apple mobile */
  html.apple-premium .nav-button,
  html.instagram-premium .nav-button {
    box-shadow: 0 0 15px rgba(59, 130, 246, 0.3) !important;
    position: relative;
    z-index: 2;
  }
  
  html.apple-premium .nav-button:active,
  html.instagram-premium .nav-button:active {
    box-shadow: 0 0 25px rgba(59, 130, 246, 0.5) !important;
  }
}

/* BACKGROUND shimmer keyframe - full navbar sweep left to right */
@keyframes navbarBgShimmerLTR {
  0% {
    left: -100%;
    opacity: 0;
  }
  10% {
    opacity: 0.6;
  }
  50% {
    opacity: 1;
  }
  90% {
    opacity: 0.6;
  }
  100% {
    left: 200%;
    opacity: 0;
  }
}

/* GRADIENT BACKGROUND animation - left to right color sweep */
@keyframes navbarBgGradientLTR {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

/* Inner container gradient animation - left to right */
@keyframes navbarInnerBgLTR {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

/* Border shimmer keyframe - synced with background */
@keyframes navbarBorderShimmerLTR {
  0% {
    left: -100%;
    opacity: 0;
  }
  10% {
    opacity: 0.7;
  }
  50% {
    opacity: 1;
    filter: drop-shadow(0 0 10px rgba(147, 197, 253, 1));
  }
  90% {
    opacity: 0.7;
  }
  100% {
    left: 200%;
    opacity: 0;
  }
}

/* LEFT TO RIGHT shimmer keyframe for navbar */
@keyframes navbarShimmerLTR {
  0% {
    left: -100%;
    opacity: 0;
  }
  10% {
    opacity: 0.5;
  }
  50% {
    opacity: 1;
    filter: drop-shadow(0 0 12px rgba(147, 197, 253, 0.8));
  }
  90% {
    opacity: 0.5;
  }
  100% {
    left: 200%;
    opacity: 0;
  }
}
