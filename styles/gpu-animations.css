/* ============================================================================
   120Hz ULTRA PERFORMANCE CSS - 2025 Edition
   ============================================================================
   
   GOLDEN RULES:
   1. Only animate: transform, opacity, filter
   2. NEVER animate: width, height, top, left, margin, padding
   3. Use will-change sparingly (only on actively animating elements)
   4. Use transform: translateZ(0) for GPU layer promotion
   
   ============================================================================ */

/* ============================================================================
   CSS CUSTOM PROPERTIES FOR PERFORMANCE
   ============================================================================ */
:root {
  /* Display refresh rate (set by JS) */
  --native-refresh-rate: 60;
  --target-fps: 60;
  --frame-duration: 16.67ms;
  --animation-speed: 1;
  
  /* Spring animations optimized for 120Hz */
  --spring-stiff: cubic-bezier(0.5, 1.8, 0.4, 0.8);
  --spring-smooth: cubic-bezier(0.16, 1, 0.3, 1);
  --spring-snappy: cubic-bezier(0.34, 1.56, 0.64, 1);
  
  /* Frame budgets */
  --frame-budget-120: 8.33ms;
  --frame-budget-90: 11.11ms;
  --frame-budget-60: 16.67ms;
  
  /* GPU animation base */
  --gpu-translate: translate3d(0, 0, 0);
}

/* ============================================================================
   PERFORMANCE MODE CLASSES
   ============================================================================ */
.perf-ultra {
  /* Maximum quality, all effects enabled */
  --blur-enabled: 1;
  --shadows-enabled: 1;
  --glow-enabled: 1;
  --particles-enabled: 1;
}

.perf-balanced {
  /* Reduced effects for better battery */
  --blur-enabled: 0.5;
  --shadows-enabled: 1;
  --glow-enabled: 0.5;
  --particles-enabled: 0.5;
}

.perf-power-saver {
  /* Minimal effects for maximum performance */
  --blur-enabled: 0;
  --shadows-enabled: 0.5;
  --glow-enabled: 0;
  --particles-enabled: 0;
}

/* ============================================================================
   GPU LAYER UTILITIES
   ============================================================================ */

/* Force GPU layer - use sparingly */
.gpu-layer {
  transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* GPU layer with containment */
.gpu-layer-contained {
  transform: translateZ(0);
  backface-visibility: hidden;
  contain: layout paint style;
}

/* Animate-ready (add will-change on hover/focus) */
.will-animate {
  transition: transform 0.2s var(--spring-smooth),
              opacity 0.2s var(--spring-smooth);
}

.will-animate:hover,
.will-animate:focus-within {
  will-change: transform, opacity;
}

/* ============================================================================
   OPTIMIZED TRANSITION UTILITIES
   ============================================================================ */

/* Ultra-fast micro-interactions (buttons, links) */
.transition-micro {
  transition: transform 0.1s var(--spring-snappy),
              opacity 0.1s ease-out;
}

/* Standard UI transitions */
.transition-ui {
  transition: transform 0.2s var(--spring-smooth),
              opacity 0.2s ease-out;
}

/* Smooth content transitions */
.transition-content {
  transition: transform 0.35s var(--spring-smooth),
              opacity 0.35s ease-out;
}

/* Page-level transitions */
.transition-page {
  transition: transform 0.5s var(--spring-smooth),
              opacity 0.5s ease-out;
}

/* Adjust transition speed based on refresh rate */
.display-120hz .transition-micro { transition-duration: 0.08s; }
.display-120hz .transition-ui { transition-duration: 0.15s; }
.display-120hz .transition-content { transition-duration: 0.28s; }
.display-120hz .transition-page { transition-duration: 0.4s; }

/* ============================================================================
   HOVER EFFECTS (GPU-Only)
   ============================================================================ */

/* Scale up on hover */
.hover-lift {
  transition: transform 0.2s var(--spring-smooth),
              box-shadow 0.2s ease-out;
}

.hover-lift:hover {
  transform: translateY(-4px) translateZ(0);
  box-shadow: 0 12px 24px -8px rgba(0, 0, 0, 0.2);
}

/* Scale effect */
.hover-scale {
  transition: transform 0.2s var(--spring-snappy);
}

.hover-scale:hover {
  transform: scale(1.02) translateZ(0);
}

/* Glow effect */
.hover-glow {
  position: relative;
  transition: transform 0.2s var(--spring-smooth);
}

.hover-glow::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  opacity: 0;
  background: radial-gradient(circle at center, rgba(255,255,255,0.15), transparent 70%);
  transition: opacity 0.3s ease-out;
  pointer-events: none;
  transform: translateZ(0);
}

.hover-glow:hover::after {
  opacity: var(--glow-enabled, 1);
}

/* ============================================================================
   SCROLL-LINKED ANIMATION UTILITIES
   ============================================================================ */

/* Fade in on scroll */
.scroll-fade-in {
  opacity: 0;
  transform: translateY(30px) translateZ(0);
  transition: opacity 0.6s ease-out, transform 0.6s var(--spring-smooth);
}

.scroll-fade-in.is-visible {
  opacity: 1;
  transform: translateY(0) translateZ(0);
}

/* Slide in from left */
.scroll-slide-left {
  opacity: 0;
  transform: translateX(-40px) translateZ(0);
  transition: opacity 0.5s ease-out, transform 0.5s var(--spring-smooth);
}

.scroll-slide-left.is-visible {
  opacity: 1;
  transform: translateX(0) translateZ(0);
}

/* Slide in from right */
.scroll-slide-right {
  opacity: 0;
  transform: translateX(40px) translateZ(0);
  transition: opacity 0.5s ease-out, transform 0.5s var(--spring-smooth);
}

.scroll-slide-right.is-visible {
  opacity: 1;
  transform: translateX(0) translateZ(0);
}

/* Scale up on scroll */
.scroll-scale {
  opacity: 0;
  transform: scale(0.95) translateZ(0);
  transition: opacity 0.5s ease-out, transform 0.5s var(--spring-smooth);
}

.scroll-scale.is-visible {
  opacity: 1;
  transform: scale(1) translateZ(0);
}

/* ============================================================================
   LOADING STATES (GPU-Optimized)
   ============================================================================ */

/* Skeleton loading animation */
@keyframes skeleton-pulse {
  0%, 100% {
    opacity: 0.3;
    filter: drop-shadow(0 0 2px rgba(59, 130, 246, 0.3));
  }
  50% {
    opacity: 0.8;
    filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.6));
  }
}

.skeleton {
  animation: skeleton-shimmer 2s ease-in-out infinite;
  background: linear-gradient(90deg, 
    rgba(59, 130, 246, 0.05) 0%,
    rgba(59, 130, 246, 0.15) 20%,
    rgba(59, 130, 246, 0.1) 50%,
    rgba(59, 130, 246, 0.15) 80%,
    rgba(59, 130, 246, 0.05) 100%
  );
  background-size: 200% 100%;
  filter: drop-shadow(0 0 3px rgba(59, 130, 246, 0.4));
}

@keyframes skeleton-shimmer {
  0% {
    transform: translateX(-100%) translateZ(0);
    opacity: 0.4;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateX(100%) translateZ(0);
    opacity: 0.4;
  }
}

/* ============================================================================
   BUTTON OPTIMIZATIONS
   ============================================================================ */

button,
.btn,
[role="button"] {
  /* GPU layer for instant response */
  transform: translateZ(0);
  transition: transform 0.15s var(--spring-snappy),
              opacity 0.15s ease-out,
              background-color 0.15s ease-out;
  /* Prevent tap delay on mobile */
  touch-action: manipulation;
  /* No tap highlight */
  -webkit-tap-highlight-color: transparent;
}

button:active,
.btn:active,
[role="button"]:active {
  transform: scale(0.97) translateZ(0);
}

/* ============================================================================
   MODAL/OVERLAY OPTIMIZATIONS
   ============================================================================ */

.modal-backdrop {
  /* GPU-accelerated backdrop */
  backdrop-filter: blur(calc(8px * var(--blur-enabled, 1)));
  -webkit-backdrop-filter: blur(calc(8px * var(--blur-enabled, 1)));
  background: rgba(0, 0, 0, 0.5);
  opacity: 0;
  transition: opacity 0.3s ease-out;
  transform: translateZ(0);
}

.modal-backdrop.is-open {
  opacity: 1;
}

.modal-content {
  transform: scale(0.95) translateY(10px) translateZ(0);
  opacity: 0;
  transition: transform 0.3s var(--spring-smooth),
              opacity 0.2s ease-out;
}

.modal-content.is-open {
  transform: scale(1) translateY(0) translateZ(0);
  opacity: 1;
}

/* ============================================================================
   LENIS SMOOTH SCROLL OVERRIDES
   ============================================================================ */

html.lenis,
html.lenis body {
  height: auto;
}

.lenis.lenis-smooth {
  scroll-behavior: auto !important;
}

.lenis.lenis-smooth [data-lenis-prevent] {
  overscroll-behavior: contain;
}

.lenis.lenis-stopped {
  overflow: hidden;
}

.lenis.lenis-smooth iframe {
  pointer-events: none;
}

/* ============================================================================
   RESPONSIVE 120Hz ADJUSTMENTS
   ============================================================================ */

/* Mobile: Lighter animations for battery */
@media (max-width: 768px) and (hover: none) {
  .hover-lift:hover,
  .hover-scale:hover {
    /* Disable hover effects on touch devices */
    transform: none;
  }
  
  /* Faster animations on mobile */
  .transition-content {
    transition-duration: 0.25s;
  }
  
  .transition-page {
    transition-duration: 0.35s;
  }
}

/* ============================================================================
   DESKTOP PERFORMANCE OPTIMIZATIONS
   Optimized for Apple Silicon M1+ and high-performance desktops
   ============================================================================ */

/* High-performance desktop mode */
.desktop-optimized,
.high-performance {
  /* Enable GPU compositing hints */
  --gpu-compositing: true;
  --animation-quality: high;
}

/* Desktop with 120Hz+ displays */
.desktop-optimized.display-120hz,
.high-performance.display-120hz {
  /* Faster transitions for high-refresh displays */
  --transition-micro: 0.06s;
  --transition-ui: 0.12s;
  --transition-content: 0.22s;
  --transition-page: 0.35s;
}

/* Desktop-specific smooth scrolling */
@media (min-width: 769px) and (hover: hover) {
  html.desktop-optimized {
    /* Use native smooth scroll momentum */
    scroll-behavior: auto;
  }
  
  /* Optimize all transforms for GPU */
  .desktop-optimized * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  /* GPU layer promotion for interactive elements */
  .desktop-optimized button,
  .desktop-optimized a,
  .desktop-optimized [role="button"],
  .desktop-optimized .interactive {
    transform: translateZ(0);
    will-change: transform, opacity;
  }
  
  /* Faster hover transitions on desktop */
  .desktop-optimized .hover-lift {
    transition: transform 0.15s var(--spring-smooth),
                box-shadow 0.15s ease-out;
  }
  
  .desktop-optimized .hover-scale {
    transition: transform 0.12s var(--spring-snappy);
  }
  
  /* Smooth hover states */
  .desktop-optimized .hover-lift:hover {
    transform: translateY(-6px) translateZ(0);
    box-shadow: 0 16px 32px -8px rgba(0, 0, 0, 0.25);
  }
  
  .desktop-optimized .hover-scale:hover {
    transform: scale(1.03) translateZ(0);
  }
}

/* Apple Silicon Mac optimizations */
.desktop-optimized.display-120hz,
.apple-silicon {
  /* Ultra-smooth spring animations */
  --spring-stiff: cubic-bezier(0.45, 1.85, 0.35, 0.85);
  --spring-smooth: cubic-bezier(0.14, 1, 0.28, 1);
  --spring-snappy: cubic-bezier(0.32, 1.6, 0.62, 1);
}

/* High-spec desktop (16GB+ RAM, discrete GPU) */
.high-performance {
  /* Enable all visual effects */
  --blur-enabled: 1;
  --shadows-enabled: 1;
  --glow-enabled: 1;
  --particles-enabled: 1;
  --reflections-enabled: 1;
}

/* Backdrop blur optimizations for desktop */
@media (min-width: 769px) {
  .desktop-optimized .backdrop-blur-sm {
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
  }
  
  .desktop-optimized .backdrop-blur-md {
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }
  
  .desktop-optimized .backdrop-blur-lg {
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
  }
  
  /* GPU-accelerated glass effect */
  .desktop-optimized .glass-effect {
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    transform: translateZ(0);
  }
}

/* Ultra-wide monitors (2560px+) often have high refresh */
@media (min-width: 2560px) {
  /* Larger movement for bigger screens */
  .hover-lift:hover {
    transform: translateY(-8px) translateZ(0);
  }
  
  .scroll-fade-in {
    transform: translateY(60px) translateZ(0);
  }
  
  .scroll-slide-left {
    transform: translateX(-60px) translateZ(0);
  }
  
  .scroll-slide-right {
    transform: translateX(60px) translateZ(0);
  }
}

/* 4K displays (3840px+) */
@media (min-width: 3840px) {
  .hover-lift:hover {
    transform: translateY(-10px) translateZ(0);
    box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.3);
  }
}

/* ============================================================================
   DESKTOP 3D/CANVAS OPTIMIZATIONS
   ============================================================================ */

@media (min-width: 769px) {
  /* Force GPU compositing for canvas elements on desktop */
  .desktop-optimized canvas,
  .high-performance canvas {
    transform: translateZ(0);
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    /* Allow canvas to use full GPU power */
    image-rendering: optimizeSpeed;
  }
  
  /* Spline 3D scenes on high-end desktops */
  .desktop-optimized [data-spline],
  .high-performance [data-spline] {
    transform: translate3d(0, 0, 0);
    backface-visibility: hidden;
    /* Hint to browser for GPU acceleration */
    will-change: contents;
  }
  
  /* WebGL context optimization */
  .desktop-optimized .webgl-container,
  .high-performance .webgl-container {
    contain: strict;
    transform: translateZ(0);
  }
}

/* ============================================================================
   PRINT STYLES (Disable animations)
   ============================================================================ */

@media print {
  *,
  *::before,
  *::after {
    animation: none !important;
    transition: none !important;
    transform: none !important;
  }
}
