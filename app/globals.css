@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:where(.dark, .dark *));

@import "./styles/00-base.css";
@import "./styles/10-scroll-foundation.css";
@import "./styles/20-cls-lcp.css";
@import "./styles/30-performance-scroll.css";
@import "./styles/40-theme-overlays.css";
@import "./styles/50-fps-overrides.css";
@import "./styles/60-desktop-zindex-fix.css";
@import "./styles/70-mobile-performance.css";
@import "./styles/90-scroll-anywhere.css";
@import "../styles/themes/supreme-z-index.css";
@import "../styles/modal-scroll-lock.css";
@import "../styles/browsers/_samsung.css";
@import "../styles/browsers/_chrome.css";
@import "../styles/browsers/_safari.css";
@import "../styles/browsers/_inapp.css";

:root {
  --bm-drunk-x: 0px;
  --bm-drunk-rot: 0deg;
}

/* Drunk scroll effects - ONLY active during showcase scroll animation */
/* Non-blocking: purely visual, doesn't affect scroll functionality */
html.bm-drunk-scroll body {
  transform: translate3d(var(--bm-drunk-x), 0, 0) rotate(var(--bm-drunk-rot)) translateZ(0);
  transform-origin: 50% 30%;
  will-change: transform;
  pointer-events: none; /* Allow clicks to pass through during animation */
}

html.bm-drunk-scroll body > * {
  pointer-events: auto; /* Re-enable pointer events on children */
}

/* Hide horizontal scrollbar for the world map scroller */
.world-map-scroll {
  scrollbar-width: none;
}

.world-map-scroll::-webkit-scrollbar {
  width: 0;
  height: 0;
}

/* Store desktop column scrollbars — GPU-accelerated, zero JS overhead */
@media (min-width: 1024px) {
  /* Page-level snap container so columns lock to viewport center */
  .store-snap-scroll {
    scroll-snap-type: y proximity;
    scroll-behavior: auto;
  }

  /* Columns container: sticky so it locks full-screen when scrolled into view */
  .store-columns-container {
    position: sticky;
    top: 0;
    z-index: 10;
    /* Snap target: page-level snap will center this */
    scroll-snap-align: start;
    scroll-snap-stop: always;
  }

  .store-column-scroll {
    overscroll-behavior: contain;
    scrollbar-gutter: stable;
    touch-action: pan-y;
    scrollbar-color: rgb(0, 0, 0) transparent;
    scrollbar-width: thin;
    /* GPU-accelerate scroll container */
    will-change: scroll-position;
    contain: layout style paint;
    /* Promote to own compositing layer for off-main-thread scrolling */
    transform: translateZ(0);
    /* Smooth scroll for programmatic calls, but native for wheel/touch */
    scroll-behavior: auto;
  }

  .store-column-scroll::-webkit-scrollbar {
    width: 10px;
  }

  .store-column-scroll::-webkit-scrollbar-track {
    background: transparent;
  }

  .store-column-scroll::-webkit-scrollbar-thumb {
    background-color: rgb(0, 0, 0);
    border-radius: 999px;
    border: 2px solid transparent;
    background-clip: content-box;
  }

  /* RIGHT COLUMN: scrollbar on the left side via direction trick */
  .store-col-right {
    direction: rtl;
  }
  .store-col-right > .store-col-right-inner {
    direction: ltr;
  }

  /* Column container — prevent scroll leaking from divider gap */
  .store-column-scroll:not(:hover) {
    pointer-events: auto;
  }

  /* Hover highlight on columns to show they're independently scrollable */
  .store-col-left,
  .store-col-right {
    transition: box-shadow 0.3s ease;
  }
  .store-col-left:hover,
  .store-col-right:hover {
    box-shadow: inset 0 0 0 1px rgba(255,255,255,0.06);
  }

  /* Scroll hint divider animation */
  .store-scroll-hint {
    opacity: 1;
    transition: opacity 0.8s ease;
  }
}

/* =============================================
   GLOBAL THEME ACCENT OVERRIDES (ALL MODALS)
   ============================================= */

/* Modal containers (broad coverage) */
[role="dialog"],
.modal,
.modal-content,
.modal-container,
.modal-card,
.pm-modal-content,
.recruit-modal-content,
.affiliate-modal,
.theme-config-modal-supreme,
.theme-selector-modal-supreme {
  border-color: var(--neon-border, rgba(255, 255, 255, 0.3)) !important;
  box-shadow: var(--neon-glow, 0 0 20px rgba(255, 255, 255, 0.15)) !important;
}

/* Modal headers and separators */
.modal-header,
.modal-title,
.modal-footer,
.modal-separator,
.modal-divider {
  border-color: var(--neon-border-soft, rgba(255, 255, 255, 0.2)) !important;
}

/* Close buttons and action icons inside modals */
[data-modal-close="true"],
.modal-close,
.modal-action {
  color: rgba(var(--neon-accent-rgb, 255, 255, 255), 0.8) !important;
  border-color: var(--neon-border-soft, rgba(255, 255, 255, 0.2)) !important;
  box-shadow: 0 0 10px rgba(var(--neon-accent-rgb, 255, 255, 255), 0.3) !important;
}

/* Modal accent text */
.modal-accent,
.modal-title,
.modal-subtitle,
.modal-highlight {
  color: rgba(var(--neon-accent-rgb, 255, 255, 255), 0.85) !important;
  text-shadow: 0 0 10px rgba(var(--neon-accent-rgb, 255, 255, 255), 0.4);
}

/* =============================================
   GLOBAL THEME ACCENT OVERRIDES (FOOTER)
   ============================================= */

footer,
[data-footer],
.footer,
.footer-section,
.site-footer {
  border-color: var(--neon-border-soft, rgba(255, 255, 255, 0.2)) !important;
}

footer a,
[data-footer] a,
.footer a,
.footer-section a,
.site-footer a {
  color: rgba(var(--neon-accent-rgb, 255, 255, 255), 0.8) !important;
  text-shadow: 0 0 8px rgba(var(--neon-accent-rgb, 255, 255, 255), 0.3);
}

footer a:hover,
[data-footer] a:hover,
.footer a:hover,
.footer-section a:hover,
.site-footer a:hover {
  color: rgba(var(--neon-accent-rgb, 255, 255, 255), 1) !important;
  text-shadow: 0 0 12px rgba(var(--neon-accent-rgb, 255, 255, 255), 0.6);
}

footer .accent,
[data-footer] .accent,
.footer .accent,
.footer-section .accent,
.site-footer .accent {
  color: rgba(var(--neon-accent-rgb, 255, 255, 255), 0.9) !important;
  text-shadow: 0 0 10px rgba(var(--neon-accent-rgb, 255, 255, 255), 0.5);
}

/* =============================================
   GLOBAL THEME ACCENT OVERRIDES (PAGES + NAV + HUB)
   ============================================= */

/* Core page wrappers */
main,
section:not([data-apple-section]):not([data-products-section]),
article,
[data-theme-aware],
[data-page],
[data-section] {
  --page-accent: var(--neon-accent, var(--accent-color, #ffffff));
  --page-accent-rgb: var(--neon-accent-rgb, var(--accent-rgb, 255, 255, 255));
}

/* =============================================
   APPLE SECTION ISOLATION — defeat all theme
   overlays, neon borders, accent text, etc.
   ============================================= */
[data-apple-section],
[data-apple-section-wrapper],
[data-products-section],
[data-products-section-wrapper] {
  --page-accent: unset !important;
  --page-accent-rgb: unset !important;
  --neon-accent: unset !important;
  --neon-accent-rgb: unset !important;
  --neon-border: unset !important;
  --neon-border-soft: unset !important;
  --neon-glow: unset !important;
  --accent-color: unset !important;
  --accent-rgb: unset !important;
  filter: none !important;
  -webkit-filter: none !important;
}

[data-apple-section] *,
[data-apple-section-wrapper] *,
[data-products-section] *,
[data-products-section-wrapper] * {
  text-shadow: none !important;
  transition-delay: 0s !important;
}

/* =============================================
   CRYPTO CHECKOUT - LIGHT APPLE STYLE OVERRIDES
   ============================================= */

.crypto-apple {
  color: #111111;
}

.crypto-apple [class*="text-white/"] {
  color: rgba(0, 0, 0, 0.6) !important;
}

.crypto-apple .text-white {
  color: #111111 !important;
}

.crypto-apple [class*="bg-white/"] {
  background-color: rgba(0, 0, 0, 0.04) !important;
}

.crypto-apple [class*="border-white/"] {
  border-color: rgba(0, 0, 0, 0.12) !important;
}

.crypto-apple input,
.crypto-apple textarea {
  color: #111111 !important;
  background-color: rgba(0, 0, 0, 0.03) !important;
  border-color: rgba(0, 0, 0, 0.12) !important;
}

.crypto-apple input::placeholder,
.crypto-apple textarea::placeholder {
  color: rgba(0, 0, 0, 0.35) !important;
}


/* =============================================
   APPLE BLACK + WHITE SURFACE
   ============================================= */

[data-apple-bw] {
  background-color: #000000 !important;
  color: #f5f5f7;
  background-image:
    radial-gradient(circle at top, rgba(255, 255, 255, 0.18), transparent 55%),
    linear-gradient(180deg, rgba(255, 255, 255, 0.04), rgba(0, 0, 0, 0.2));
  background-attachment: fixed;
}

[data-apple-bw] a {
  color: #f5f5f7;
}

[data-apple-bw] a:hover {
  color: #ffffff;
}

/* Navbar + header + hub wrappers */
nav,
header,
.navbar,
.nav,
.nav-bar,
.nav-container,
.nav-wrapper,
.nav-content,
.header,
.header-bar,
.ultimate-hub,
.ultimate-hub-container,
.hub,
.hub-container,
.hub-panel {
  border-color: var(--neon-border-soft, rgba(255, 255, 255, 0.2)) !important;
  box-shadow: 0 0 20px rgba(var(--neon-accent-rgb, 255, 255, 255), 0.15);
}

/* Nav links + hub links */
nav a,
header a,
.navbar a,
.nav a,
.nav-bar a,
.nav-container a,
.ultimate-hub a,
.hub a {
  color: rgba(var(--neon-accent-rgb, 255, 255, 255), 0.85) !important;
  text-shadow: 0 0 8px rgba(var(--neon-accent-rgb, 255, 255, 255), 0.3);
}

nav a:hover,
header a:hover,
.navbar a:hover,
.nav a:hover,
.nav-bar a:hover,
.nav-container a:hover,
.ultimate-hub a:hover,
.hub a:hover {
  color: rgba(var(--neon-accent-rgb, 255, 255, 255), 1) !important;
  text-shadow: 0 0 12px rgba(var(--neon-accent-rgb, 255, 255, 255), 0.6);
}

/* Active nav items + hub highlights */
nav .active,
header .active,
.navbar .active,
.nav .active,
.nav-bar .active,
.nav-container .active,
.ultimate-hub .active,
.hub .active,
.hub-highlight,
.hub-accent,
.nav-accent {
  color: rgba(var(--neon-accent-rgb, 255, 255, 255), 0.95) !important;
  text-shadow: 0 0 12px rgba(var(--neon-accent-rgb, 255, 255, 255), 0.7);
}

/* =============================================
   AFFILIATE MODAL - NEON BLUE THEME STYLES
   ============================================= */

/* Custom range slider styling for affiliate calculator */
input[type="range"].neon-slider,
.affiliate-modal input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  height: 8px;
  border-radius: 9999px;
  background: rgba(255, 255, 255, 0.2);
  outline: none;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #ffffff;
  border: 2px solid #ffffff;
  cursor: pointer;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.6);
  transition: all 0.2s ease;
}

input[type="range"]::-webkit-slider-thumb:hover {
  transform: scale(1.1);
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
}

input[type="range"]::-moz-range-thumb {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #ffffff;
  border: 2px solid #ffffff;
  cursor: pointer;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.6);
  transition: all 0.2s ease;
}

input[type="range"]::-moz-range-thumb:hover {
  transform: scale(1.1);
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
}

/* Neon text glow effect */
.neon-text-blue {
  color: #ffffff;
  text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
}

.neon-text-cyan {
  color: #ffffff;
  text-shadow: 0 0 15px rgba(255, 255, 255, 0.6);
}

/* Static neon border glow */
.neon-border-blue {
  border: 2px solid rgba(255, 255, 255, 0.6);
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
}

.neon-border-cyan {
  border: 2px solid rgba(255, 255, 255, 0.6);
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
}

/* Neon card hover effect (static, no animation) */
.neon-card-hover:hover {
  border-color: rgba(255, 255, 255, 0.9);
  box-shadow: 0 0 30px rgba(255, 255, 255, 0.6);
}

/* Mobile-optimized scrollbar for affiliate modal */
.affiliate-modal::-webkit-scrollbar {
  width: 6px;
}

.affiliate-modal::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 3px;
}

.affiliate-modal::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.5);
  border-radius: 3px;
}

.affiliate-modal::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.7);
}

/* =============================================
   GLOBAL MODAL CLOSE BUTTON - NEON + UI STATE
   ============================================= */

body[data-modal-open="true"] button[data-modal-close="true"],
body[data-modal-open="true"] button[aria-label*="Close" i],
body[data-modal-open="true"] button[title*="Close" i] {
  border: 1px solid rgba(255, 255, 255, 0.6);
  background: rgba(2, 6, 23, 0.7);
  color: #e2e8f0;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.6), 0 0 20px rgba(255, 255, 255, 0.35);
  transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease, border-color 0.2s ease;
}

body[data-modal-open="true"] button[data-modal-close="true"]:hover,
body[data-modal-open="true"] button[aria-label*="Close" i]:hover,
body[data-modal-open="true"] button[title*="Close" i]:hover {
  background: rgba(15, 23, 42, 0.85);
  border-color: rgba(255, 255, 255, 0.8);
  box-shadow: 0 0 14px rgba(255, 255, 255, 0.7), 0 0 28px rgba(255, 255, 255, 0.6);
  transform: translateY(-1px);
}

@media (max-width: 640px) {
  body[data-modal-open="true"] button[data-modal-close="true"],
  body[data-modal-open="true"] button[aria-label*="Close" i],
  body[data-modal-open="true"] button[title*="Close" i] {
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.7), 0 0 12px rgba(239, 68, 68, 0.7);
    border-color: rgba(255, 255, 255, 0.7);
  }
}

/* =============================================
   STORE - SCROLLBAR HIDING & MOBILE UTILITIES
   ============================================= */

/* Hide scrollbar utility */
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* Safe area padding for iOS */
.pb-safe {
  padding-bottom: env(safe-area-inset-bottom, 0);
}
.safe-area-inset-bottom {
  padding-bottom: env(safe-area-inset-bottom, 0);
}

/* Touch scroll momentum */
.touch-pan-x {
  touch-action: pan-x;
}
.touch-pan-y {
  touch-action: pan-y;
}

/* Overscroll behavior */
.overscroll-contain {
  overscroll-behavior: contain;
}

/* Store-specific optimizations */
.store-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.75rem;
}

@media (min-width: 640px) {
  .store-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
  }
}

@media (min-width: 1024px) {
  .store-grid {
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5rem;
  }
}

/* Luxury chrome gradient text */
.chrome-text {
  background: linear-gradient(180deg, #ffffff 0%, rgba(255, 255, 255, 0.6) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Glassmorphism effect */
.glass {
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

/* Store button styles */
.store-btn-primary {
  @apply h-12 px-6 bg-white text-black rounded-xl font-medium 
         flex items-center justify-center gap-2 
         hover:bg-white/90 active:scale-[0.98] transition-all;
}

.store-btn-secondary {
  @apply h-12 px-6 bg-white/10 text-white rounded-xl font-medium
         flex items-center justify-center gap-2 border border-white/10
         hover:bg-white/20 active:scale-[0.98] transition-all;
}

/* Input focus states */
.store-input {
  @apply w-full h-12 px-4 bg-white/5 border border-white/10 rounded-xl
         focus:outline-none focus:border-white/20 focus:bg-white/[0.07]
         transition-all placeholder:text-white/40;
}

/* =============================================
   STORE PAGE ISOLATION
   Prevents theme overlays from affecting store
   ============================================= */

/* When on store page, disable theme overlays */
[data-store-page] ~ [data-theme-overlay],
[data-store-page] ~ #theme-filter-overlay,
.store-layout ~ [data-theme-overlay],
.store-layout ~ #theme-filter-overlay {
  display: none !important;
  opacity: 0 !important;
  visibility: hidden !important;
}

/* Store layout isolation */
.store-layout {
  position: relative;
  z-index: 1;
  isolation: isolate;
  background: #ffffff !important;
}

/* Light-mode memory guard defaults for store pages */
.store-layout,
[data-store-page],
body.store-page-body {
  --memory-guard-bg: rgba(255, 255, 255, 0.98);
  --memory-guard-fg: rgba(17, 17, 17, 0.92);
  --memory-guard-link: rgba(17, 17, 17, 0.8);
  --memory-guard-modal-bg: rgba(255, 255, 255, 0.98);
  --memory-guard-modal-fg: rgba(17, 17, 17, 0.92);
}

/* Prevent any filter bleeding into store */
.store-layout,
.store-layout *:not([class*="backdrop-blur"]) {
  filter: none !important;
  -webkit-filter: none !important;
}

/* Store-specific scroll behavior */
.store-layout {
  -webkit-overflow-scrolling: touch;
  touch-action: pan-y pan-x;
  overscroll-behavior: contain;
  scroll-behavior: auto;
}

/* Store featured section: prevent glass panels between map and products */
.store-layout .featured-section-clean {
  background: #000 !important;
  border: 0 !important;
  box-shadow: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

.store-layout .featured-section-clean::before,
.store-layout .featured-section-clean::after {
  content: none !important;
}

/* Timeline text animations — never hide text, only animate transform */
@keyframes tl-fadeInUp {
  from { transform: translateY(16px); opacity: 0.2; }
  to   { transform: translateY(0); opacity: 1; }
}
@keyframes tl-slideInLeft {
  from { transform: translateX(-16px); opacity: 0.2; }
  to   { transform: translateX(0); opacity: 1; }
}
@keyframes tl-scaleIn {
  from { transform: scale(0.92); opacity: 0.2; }
  to   { transform: scale(1); opacity: 1; }
}
.tl-fade-up    { animation: tl-fadeInUp   0.7s ease-out both; }
.tl-slide-left { animation: tl-slideInLeft 0.5s ease-out both; }
.tl-scale-in   { animation: tl-scaleIn    0.8s ease-out both; }
.tl-delay-1    { animation-delay: 100ms; }
.tl-delay-2    { animation-delay: 200ms; }
.tl-delay-3    { animation-delay: 300ms; }
.tl-delay-4    { animation-delay: 400ms; }

/* ============================================================================
   MOBILE MOSAIC GRID — 30 varied card sizes across 3 product sections
   Simple 2-col base that fills the screen. Cards get span-2 (full), span-1
   (half), or grid-row:span 2 (tall) for variety. No fragile deep selectors.
   ============================================================================ */
@media (max-width: 639px) {
  /* Force all child grids/flex/columns into a 2-col grid */
  [class*="mobile-mosaic-"] .grid,
  [class*="mobile-mosaic-"] .flex:not(.flex-col),
  [class*="mobile-mosaic-"] [class*="columns-"],
  [class*="mobile-mosaic-"] .grid-perf,
  [class*="mobile-mosaic-"] .grid-float,
  [class*="mobile-mosaic-"] .snap-x {
    display: grid !important;
    grid-template-columns: repeat(2, 1fr) !important;
    grid-auto-flow: dense !important;
    gap: 8px !important;
    column-count: unset !important;
    overflow-x: visible !important;
  }

  /* Every card fills its cell fully */
  [class*="mobile-mosaic-"] .grid-card,
  [class*="mobile-mosaic-"] .snap-start,
  [class*="mobile-mosaic-"] .break-inside-avoid,
  [class*="mobile-mosaic-"] article {
    width: 100% !important;
    min-width: 0 !important;
    height: 100% !important;
    min-height: 0;
    overflow: hidden;
    break-inside: avoid;
  }

  /* ── Section 1: All Products — 10 unique sizes ─────────────── */
  .mobile-mosaic-products .grid-card:nth-child(1)  { grid-column: span 2; }                    /* full */
  .mobile-mosaic-products .grid-card:nth-child(2)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-products .grid-card:nth-child(3)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-products .grid-card:nth-child(4)  { grid-column: span 2; }                    /* full */
  .mobile-mosaic-products .grid-card:nth-child(5)  { grid-column: span 1; grid-row: span 2; }  /* half tall */
  .mobile-mosaic-products .grid-card:nth-child(6)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-products .grid-card:nth-child(7)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-products .grid-card:nth-child(8)  { grid-column: span 2; }                    /* full */
  .mobile-mosaic-products .grid-card:nth-child(9)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-products .grid-card:nth-child(10) { grid-column: span 1; }                    /* half */
  /* overflow cycles */
  .mobile-mosaic-products .grid-card:nth-child(10n+11) { grid-column: span 2; }
  .mobile-mosaic-products .grid-card:nth-child(10n+12) { grid-column: span 1; }
  .mobile-mosaic-products .grid-card:nth-child(10n+13) { grid-column: span 1; }
  .mobile-mosaic-products .grid-card:nth-child(10n+14) { grid-column: span 2; }
  .mobile-mosaic-products .grid-card:nth-child(10n+15) { grid-column: span 1; grid-row: span 2; }
  .mobile-mosaic-products .grid-card:nth-child(10n+16) { grid-column: span 1; }
  .mobile-mosaic-products .grid-card:nth-child(10n+17) { grid-column: span 1; }
  .mobile-mosaic-products .grid-card:nth-child(10n+18) { grid-column: span 2; }
  .mobile-mosaic-products .grid-card:nth-child(10n+19) { grid-column: span 1; }
  .mobile-mosaic-products .grid-card:nth-child(10n+20) { grid-column: span 1; }

  /* ── Section 2: Featured — 10 unique sizes ─────────────────── */
  .mobile-mosaic-featured .grid-card:nth-child(1)  { grid-column: span 1; grid-row: span 2; }  /* half tall */
  .mobile-mosaic-featured .grid-card:nth-child(2)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-featured .grid-card:nth-child(3)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-featured .grid-card:nth-child(4)  { grid-column: span 2; }                    /* full */
  .mobile-mosaic-featured .grid-card:nth-child(5)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-featured .grid-card:nth-child(6)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-featured .grid-card:nth-child(7)  { grid-column: span 2; }                    /* full */
  .mobile-mosaic-featured .grid-card:nth-child(8)  { grid-column: span 1; grid-row: span 2; }  /* half tall */
  .mobile-mosaic-featured .grid-card:nth-child(9)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-featured .grid-card:nth-child(10) { grid-column: span 1; }                    /* half */
  /* overflow cycles */
  .mobile-mosaic-featured .grid-card:nth-child(10n+11) { grid-column: span 1; grid-row: span 2; }
  .mobile-mosaic-featured .grid-card:nth-child(10n+12) { grid-column: span 1; }
  .mobile-mosaic-featured .grid-card:nth-child(10n+13) { grid-column: span 1; }
  .mobile-mosaic-featured .grid-card:nth-child(10n+14) { grid-column: span 2; }
  .mobile-mosaic-featured .grid-card:nth-child(10n+15) { grid-column: span 1; }

  /* ── Section 3: Timeline — 10 unique sizes ─────────────────── */
  .mobile-mosaic-timeline .grid-card:nth-child(1)  { grid-column: span 2; }                    /* full */
  .mobile-mosaic-timeline .grid-card:nth-child(2)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-timeline .grid-card:nth-child(3)  { grid-column: span 1; grid-row: span 2; }  /* half tall */
  .mobile-mosaic-timeline .grid-card:nth-child(4)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-timeline .grid-card:nth-child(5)  { grid-column: span 2; }                    /* full */
  .mobile-mosaic-timeline .grid-card:nth-child(6)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-timeline .grid-card:nth-child(7)  { grid-column: span 1; }                    /* half */
  .mobile-mosaic-timeline .grid-card:nth-child(8)  { grid-column: span 2; }                    /* full */
  .mobile-mosaic-timeline .grid-card:nth-child(9)  { grid-column: span 1; grid-row: span 2; }  /* half tall */
  .mobile-mosaic-timeline .grid-card:nth-child(10) { grid-column: span 1; }                    /* half */
  /* overflow cycles */
  .mobile-mosaic-timeline .grid-card:nth-child(10n+11) { grid-column: span 2; }
  .mobile-mosaic-timeline .grid-card:nth-child(10n+12) { grid-column: span 1; }
  .mobile-mosaic-timeline .grid-card:nth-child(10n+13) { grid-column: span 1; grid-row: span 2; }
  .mobile-mosaic-timeline .grid-card:nth-child(10n+14) { grid-column: span 1; }
  .mobile-mosaic-timeline .grid-card:nth-child(10n+15) { grid-column: span 2; }

  /* Tall cards need explicit min-height for their row-span */
  [class*="mobile-mosaic-"] .grid-card[style*="grid-row"],
  [class*="mobile-mosaic-"] .grid-card:is(
    .mobile-mosaic-products .grid-card:nth-child(5),
    .mobile-mosaic-products .grid-card:nth-child(10n+15),
    .mobile-mosaic-featured .grid-card:nth-child(1),
    .mobile-mosaic-featured .grid-card:nth-child(8),
    .mobile-mosaic-featured .grid-card:nth-child(10n+11),
    .mobile-mosaic-timeline .grid-card:nth-child(3),
    .mobile-mosaic-timeline .grid-card:nth-child(9),
    .mobile-mosaic-timeline .grid-card:nth-child(10n+13)
  ) {
    min-height: 300px;
  }

  /* Fill all cards edge-to-edge, compress padding for mobile */
  [class*="mobile-mosaic-"] .product-card-premium {
    border-radius: 12px !important;
  }

  /* Fix carousel / ribbon overrides */
  [class*="mobile-mosaic-"] .snap-start {
    min-width: 0 !important;
  }
}

/* ============================================================================
   PRODUCT CARD SHIMMER — Boost.py compatible
   Use data-shimmer attribute so boost.py can whitelist these animations
   ============================================================================ */
.product-card-premium .neon-edge-top,
.product-card-premium .neon-edge-bottom,
.product-card-premium .card-shine-sweep,
.product-card-premium .card-image-shine,
.product-card-premium .badge-shimmer-el,
.product-card-premium .card-image-border {
  /* Mark as essential UI animation for boost.py compatibility */
  --boost-protected: 1;
}

/* Affiliate dashboard visual reset: white background + black text */
/* SCOPED: Only apply to actual dashboard containers, not modals/drawers */
[data-affiliate-dashboard].affiliate-dashboard-reset,
[data-affiliate-dashboard] .affiliate-dashboard-reset {
  background: #ffffff !important;
}

[data-affiliate-dashboard].affiliate-dashboard-reset *,
[data-affiliate-dashboard] .affiliate-dashboard-reset * {
  color: #000000 !important;
  text-shadow: none !important;
  background-image: none !important;
}

[data-affiliate-dashboard] .affiliate-dashboard-reset [class*="border-"] {
  border-color: rgba(0, 0, 0, 0.14) !important;
}

/* ============================================================================
   MODAL & DRAWER COLOR PROTECTION
   Prevent Safari/Chrome/In-App browsers from forcing black backgrounds
   ============================================================================ */

/* Protect all modals and drawers from browser dark mode overrides */
[role="dialog"],
[aria-modal="true"],
.modal,
.modal-content,
.drawer,
[data-modal],
[data-drawer],
[data-state="open"][role="dialog"],
body > div[class*="fixed"][class*="inset-0"]:has([role="dialog"]) {
  color-scheme: light !important;
  -webkit-color-scheme: light !important;
}

/* Ensure modal/drawer backgrounds and text aren't forced to black */
[role="dialog"] *,
[aria-modal="true"] *,
.modal *,
.modal-content *,
.drawer *,
[data-modal] *,
[data-drawer] * {
  /* Prevent browser from forcing colors */
  color-scheme: inherit !important;
}

/* Fix modal backdrops - ensure they stay as intended */
.modal-backdrop,
[data-backdrop],
.fixed.inset-0[class*="bg-black"],
div[class*="bg-black/"][class*="fixed"] {
  /* Keep backdrop colors as defined, don't let browser override */
  color-scheme: light !important;
}

/* CRITICAL: Override body/html color-scheme when ANY UI is open */
html[data-modal-open="true"],
html[data-cart-open="true"],
html[data-affiliate-open="true"],
body.modal-open,
body[data-modal-open="true"],
body[data-cart-open="true"],
body[data-active-ui="gamesDrawer"],
body[data-active-ui="supportDrawer"] {
  color-scheme: light !important;
  -webkit-color-scheme: light !important;
}

/* ============================================================================
   STORE PAGE COLOR PROTECTION
   Force light color scheme for entire store to prevent black backgrounds
   ============================================================================ */

/* Protect entire store page from browser dark mode forcing */
/* NOTE: Do NOT set background-color here — games page uses data-store-page but needs black bg */
/* NOTE: Do NOT set color-scheme on html/body — it breaks dark-themed pages like games */
/* Modals and drawers have their own inline colorScheme: 'light' protection */

/* Protect store layout children — only modals/drawers, not all elements */
/* NOTE: Do NOT use wildcard * here — it breaks dark sections like games page */
[data-store-page] [role="dialog"],
[data-store-page] [aria-modal="true"],
[data-store-page] .modal,
[data-store-page] .drawer,
body.store-page-body [role="dialog"],
body.store-page-body [aria-modal="true"],
body.store-page-body .modal,
body.store-page-body .drawer {
  color-scheme: light !important;
  -webkit-color-scheme: light !important;
  background-color: inherit !important;
}
