/* ============================================================================
   2026 CLS PREVENTION - CRITICAL FOR CORE WEB VITALS
   Prevent layout shifts by reserving space for dynamic content
   ============================================================================ */

/* CRITICAL: Fixed dimensions for Spline 3D containers - prevents CLS */
.spline-container,
[data-spline-scene],
.lazy-spline-container {
  /* Reserve exact space to prevent layout shift */
  aspect-ratio: 16 / 9;
  min-height: 300px;
  width: 100%;
  contain: strict;
  content-visibility: auto;
  contain-intrinsic-size: auto 500px;
}

/* Hero Spline - exact height reservation */
.hero-spline-wrapper,
.hero [data-spline],
.hero canvas {
  min-height: 100vh;
  min-height: 100dvh;
  height: 100vh;
  height: 100dvh;
  width: 100%;
  contain: layout size style;
}

/* Big device hero optimizations */
@media (min-width: 1440px) {
  .hero-spline-wrapper,
  .hero [data-spline],
  .hero canvas {
    height: calc(100vh - 80px); /* Account for navbar on big screens */
    min-height: calc(100vh - 80px);
    max-height: none;
    contain: layout style; /* Less restrictive containment */
  }
  
  .hero {
    height: auto !important;
    min-height: calc(100vh - 80px);
    overflow: visible;
  }
  
  /* Ensure scroll containers work properly */
  .big-display .hero-spline-wrapper {
    position: relative;
    overflow: visible;
  }
}

/* 3D Experience section - fixed 800px height */
#experience .spline-container,
#experience [data-spline-scene] {
  height: 800px;
  min-height: 800px;
  max-height: 800px;
}

/* Skeleton/Placeholder must match final content size */
.spline-skeleton,
.loading-skeleton-spline {
  aspect-ratio: 16 / 9;
  min-height: 300px;
  width: 100%;
}

/* Dynamic content containers - prevent CLS */
.dynamic-content,
[data-dynamic],
.lazy-load-wrapper {
  min-height: 100px;
  contain: layout;
}

/* Image containers - prevent CLS from images */
.image-container,
[data-image-container] {
  position: relative;
  overflow: hidden;
}

/* Font display swap to prevent FOUT CLS */
@font-face {
  font-display: swap;
}

/* Prevent CLS from web fonts */
html {
  font-synthesis: none;
  text-rendering: optimizeLegibility;
}

/* ============================================================================
   2026 LCP OPTIMIZATION - FASTER LARGEST CONTENTFUL PAINT
   Prioritize hero/above-the-fold content rendering
   ============================================================================ */

/* Hero section LCP priority */
.hero,
#hero,
[data-hero] {
  /* Ensure hero renders first */
  contain: none;
  content-visibility: visible;
}

/* Hero canvas - LCP element priority */
.hero canvas,
#hero canvas,
[data-hero] canvas {
  /* Force immediate render, no lazy loading */
  content-visibility: visible;
  contain: none;
}

/* Defer non-critical content rendering */
section:not(.hero):not(#hero),
#cta,
#features,
#experience,
#testimonials,
#ticker {
  content-visibility: auto;
  contain-intrinsic-size: auto 500px;
}

/* Reserve full-viewport space for above-the-fold sections to prevent shifts */
.viewport-full,
section.viewport-full,
#cta,
#features {
  contain-intrinsic-size: auto 100vh;
}

/* ============================================================================
   2026 CLS PREVENTION - ADDITIONAL RULES
   ============================================================================ */

/* Suspense fallback containers - must match final size */
.suspense-fallback,
[data-suspense-fallback] {
  min-height: inherit;
  height: 100%;
  width: 100%;
}

/* Lazy-loaded component wrappers */
.lazy-wrapper,
[data-lazy] {
  min-height: 100px;
  contain: layout;
}

/* Dynamic imports container */
.dynamic-import,
[data-dynamic-import] {
  min-height: 100px;
  contain: layout size;
}

/* Canvas elements - prevent resize CLS */
canvas {
  contain: strict;
  /* Canvas should not change size after initial render */
}

/* Images with aspect ratio - prevent CLS */
img[width][height] {
  aspect-ratio: attr(width) / attr(height);
  height: auto;
}

/* Next.js Image component optimization */
[data-nimg] {
  contain: layout;
}

/* Product/Card grids - fixed row heights */
.product-grid,
.card-grid,
[data-grid] {
  contain: layout;
}

.product-grid > *,
.card-grid > *,
[data-grid] > * {
  min-height: 200px;
  contain: layout;
}

/* Modal containers - centered and sized */
.modal-container,
[data-modal] {
  contain: layout style;
}
